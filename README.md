There are two code file in this branch, one is the method to calculate the queue length by detectors and the other is the method to calculate the pollution emission.
The explanation of each part in those two files is written blew.



Detector methods Code
Open and load a VISSIM network.
Set desired properties of the VISSIM simulation, and set the targeted detector, signal controller and signal group.
Start the single-step VISSIM simulation, obtain the detector occupancy data and time gaps for each simulation second. 
Define functions to calculate vehicle number n, v1, v2, v3, maximum queue length, maximum queue length time, minimum queue length and minimum queue length time.
Read and organize the signal change data file. Identify TA, TB, and TC for each cycle using the second-by-second detector occupancy data and time gaps. 
Perform queue length estimations using the algorithm and calculate the maximum queue lengths generated by VISSIM simulation. Compare the simulated and estimated maximum queue lengths and calculate the mean absolute percentage error (MAPE).



Pollution Emission Code
Open and load a VISSIM network (with EmissionModel.dll loaded in the network).
Set desired properties of the VISSIM simulation, and run the single-step simulation.
Read and obtain the emission data and occupancy date for each link segment from Link Segments Result file. 
Clean data using Interquartile range method (IQR) and z-score method respectively, and then perform linear regressions. Evaluate the linear regression model using R2 measure. 
